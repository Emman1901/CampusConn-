<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Admin Settings</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="toggleEditMode()" *ngIf="!isEditMode">
        <ion-icon slot="icon-only" name="create-outline"></ion-icon>
      </ion-button>
      <ion-button (click)="saveSettings()" *ngIf="isEditMode" color="success">
        <ion-icon slot="icon-only" name="checkmark"></ion-icon>
      </ion-button>
      <ion-button (click)="cancelEdit()" *ngIf="isEditMode" color="danger">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="settings-container">

    <!-- Admin Profile Card -->
    <ion-card class="admin-profile-card">
      <ion-card-content>
        <div class="admin-profile-header">
          <div class="avatar-section">
            <div class="avatar-container">
              <img 
                [src]="adminSettings.profileImage || 'assets/images/default-admin.png'" 
                alt="Admin Photo"
                class="admin-avatar"
              />
              <ion-button 
                *ngIf="isEditMode" 
                class="change-photo-btn" 
                fill="solid" 
                size="small"
                (click)="changePhoto()"
              >
                <ion-icon name="camera" slot="icon-only"></ion-icon>
              </ion-button>
            </div>
          </div>
          <div class="admin-info">
            <h1>{{ adminSettings.fullName }}</h1>
            <p class="admin-role">
              <ion-icon name="shield-checkmark"></ion-icon>
              {{ adminSettings.role }}
            </p>
            <ion-chip color="warning">
              <ion-icon name="key"></ion-icon>
              <ion-label>Administrator</ion-label>
            </ion-chip>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Personal Information -->
    <ion-card class="settings-section-card">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="person"></ion-icon>
          Personal Information
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          
          <ion-item>
            <ion-label position="stacked">Full Name</ion-label>
            <ion-input 
              [(ngModel)]="adminSettings.fullName" 
              [readonly]="!isEditMode"
              placeholder="Enter full name"
            ></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Email</ion-label>
            <ion-input 
              [(ngModel)]="adminSettings.email" 
              [readonly]="!isEditMode"
              type="email"
              placeholder="Enter email"
            ></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Phone Number</ion-label>
            <ion-input 
              [(ngModel)]="adminSettings.phoneNumber" 
              [readonly]="!isEditMode"
              type="tel"
              placeholder="Enter phone number"
            ></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Department</ion-label>
            <ion-select 
              [(ngModel)]="adminSettings.department" 
              [disabled]="!isEditMode"
              placeholder="Select department"
            >
              <ion-select-option value="IT Department">IT Department</ion-select-option>
              <ion-select-option value="Admin Office">Admin Office</ion-select-option>
              <ion-select-option value="Registrar">Registrar</ion-select-option>
              <ion-select-option value="Academic Affairs">Academic Affairs</ion-select-option>
              <ion-select-option value="Student Affairs">Student Affairs</ion-select-option>
            </ion-select>
          </ion-item>

        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- System Preferences -->
    <ion-card class="settings-section-card">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="settings"></ion-icon>
          System Preferences
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          
          <ion-item>
            <ion-label>
              <h3>Email Notifications</h3>
              <p>Receive email notifications for new announcements</p>
            </ion-label>
            <ion-toggle 
              [(ngModel)]="adminSettings.emailNotifications" 
              [disabled]="!isEditMode"
              color="primary"
            ></ion-toggle>
          </ion-item>

          <ion-item>
            <ion-label>
              <h3>Auto-approve Registrations</h3>
              <p>Automatically approve new student registrations</p>
            </ion-label>
            <ion-toggle 
              [(ngModel)]="adminSettings.autoApproveRegistrations" 
              [disabled]="!isEditMode"
              color="primary"
            ></ion-toggle>
          </ion-item>

          <ion-item>
            <ion-label>
              <h3>Show Admin Badge</h3>
              <p>Display admin badge on announcements</p>
            </ion-label>
            <ion-toggle 
              [(ngModel)]="adminSettings.showAdminBadge" 
              [disabled]="!isEditMode"
              color="primary"
            ></ion-toggle>
          </ion-item>

        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Appearance Settings -->
    <ion-card class="settings-section-card">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="color-palette"></ion-icon>
          Appearance
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          
          <ion-item>
            <ion-label position="stacked">Theme</ion-label>
            <ion-select 
              [(ngModel)]="adminSettings.theme" 
              [disabled]="!isEditMode"
              placeholder="Select theme"
            >
              <ion-select-option value="light">Light</ion-select-option>
              <ion-select-option value="dark">Dark</ion-select-option>
              <ion-select-option value="auto">Auto (System)</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="stacked">Items Per Page</ion-label>
            <ion-select 
              [(ngModel)]="adminSettings.itemsPerPage" 
              [disabled]="!isEditMode"
              placeholder="Select items per page"
            >
              <ion-select-option [value]="10">10 items</ion-select-option>
              <ion-select-option [value]="25">25 items</ion-select-option>
              <ion-select-option [value]="50">50 items</ion-select-option>
              <ion-select-option [value]="100">100 items</ion-select-option>
            </ion-select>
          </ion-item>

        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Security Settings -->
    <ion-card class="settings-section-card">
      <ion-card-header>
        <ion-card-title>
          <ion-icon name="lock-closed"></ion-icon>
          Security
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          
          <ion-item button (click)="changePassword()">
            <ion-icon name="key-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>Change Password</h3>
              <p>Update your account password</p>
            </ion-label>
            <ion-icon name="chevron-forward" slot="end"></ion-icon>
          </ion-item>

          <ion-item>
            <ion-label>
              <h3>Two-Factor Authentication</h3>
              <p>Add an extra layer of security</p>
            </ion-label>
            <ion-toggle 
              [(ngModel)]="adminSettings.twoFactorAuth" 
              [disabled]="!isEditMode"
              color="success"
            ></ion-toggle>
          </ion-item>

        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Last Updated -->
    <div class="last-updated">
      <ion-icon name="time-outline"></ion-icon>
      Last updated: {{ adminSettings.lastUpdated | date:'medium' }}
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons" *ngIf="!isEditMode">
      <ion-button expand="block" (click)="toggleEditMode()" color="primary">
        <ion-icon slot="start" name="create"></ion-icon>
        Edit Settings
      </ion-button>
      
      <ion-button expand="block" fill="outline" (click)="resetSettings()" color="warning">
        <ion-icon slot="start" name="refresh"></ion-icon>
        Reset to Default
      </ion-button>
    </div>

  </div>
</ion-content>